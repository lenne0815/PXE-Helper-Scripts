# 1. Define helper functions (if they aren't already in your system)
msg_info() { echo -e "\e[34m[INFO]\e[0m $1"; }
msg_ok() { echo -e "\e[32m[OK]\e[0m $1"; }

# 2. Create the service file (Requires sudo)
sudo bash -c 'cat <<EOF >/etc/systemd/system/iventoy.service
[Unit]
Description=iVentoy PXE Booter
Documentation=https://www.iventoy.com
Wants=network-online.target

[Service]
Type=forking
Environment=IVENTOY_API_ALL=1
Environment=IVENTOY_AUTO_RUN=1
Environment=LIBRARY_PATH=/opt/iventoy/lib/lin64
Environment=LD_LIBRARY_PATH=/opt/iventoy/lib/lin64
ExecStart=sh ./iventoy.sh -R start
WorkingDirectory=/opt/iventoy
Restart=on-failure

[Install]
WantedBy=multi-user.target
EOF'

# 3. Enable and start the service
msg_info "Creating Service"
sudo systemctl daemon-reload
sudo systemctl enable -q --now iventoy
msg_ok "Created Service"
